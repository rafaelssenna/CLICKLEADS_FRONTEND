<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Leads</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    .company-logo-img{height:200px;object-fit:contain;display:block;margin:0 auto}
    #loginModal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:9999}
    .login-card{width:360px;max-width:92vw;background:#0f172a;border:1px solid #1f2a44;border-radius:16px;padding:24px;color:#e2e8f0;box-shadow:0 10px 30px rgba(0,0,0,.4)}
    .login-card h3{margin:0 0 12px;font-weight:600}
    .login-card p.desc{margin:0 0 16px;color:#94a3b8;font-size:13px}
    .login-card input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #23314f;background:#0b1220;color:#e2e8f0;margin:6px 0 12px}
    .login-card button{width:100%;padding:10px 12px;border:0;border-radius:10px;background:#06b6d4;color:#001018;font-weight:700;cursor:pointer}
    .login-card .msg{min-height:18px;font-size:12px;color:#93c5fd;margin-top:6px}
    .login-logo{display:flex;align-items:center;gap:8px;margin-bottom:8px}
    .login-logo img{height:28px}
  </style>
</head>
<body>
  <header class="header">
    <div class="container"><h1 class="logo">Helsen IA</h1></div>
  </header>

  <main class="main">
    <div class="container">
      <div class="logo-section">
        <div class="company-logo-container">
          <img src="logo smart leads sem fundo.png" alt="Smart Leads" class="company-logo-img" />
        </div>
      </div>

      <div class="form-section">
        <div class="card form-card">
          <div class="form-header">
            <h2>Gerador de Leads</h2>
            <p>Encontre leads qualificados para seu negócio</p>
          </div>

          <form id="leadsForm" class="form">
            <div class="form-container">
              <div class="form-group">
                <label for="nicho" class="form-label"><span class="label-text">Nicho</span><span class="label-required">*</span></label>
                <input type="text" id="nicho" name="nicho" class="form-input" placeholder="Ex: médico, dentista, advogado" required />
              </div>

              <div class="form-group">
                <label for="local" class="form-label"><span class="label-text">Local</span><span class="label-required">*</span></label>
                <input type="text" id="local" name="local" class="form-input" placeholder="Ex: Belo Horizonte" required />
              </div>

              <div class="form-group">
                <label for="quantidade" class="form-label"><span class="label-text">Quantidade</span><span class="label-required">*</span></label>
                <input type="number" id="quantidade" name="quantidade" class="form-input" min="1" max="500" value="50" placeholder="Máximo 500 leads" required />
              </div>

              <div class="form-group">
                <div class="checkbox-group">
                  <input type="checkbox" id="somenteWhatsapp" name="somenteWhatsapp" class="form-checkbox" checked />
                  <label for="somenteWhatsapp" class="checkbox-label">
                    <span class="checkbox-text">Somente WhatsApp</span>
                    <span class="checkbox-description">Filtrar apenas números com WhatsApp</span>
                  </label>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" id="buscarBtn" class="btn btn-primary">
                  <span class="btn-text">Buscar Leads</span>
                  <div class="btn-spinner" aria-hidden="true"></div>
                </button>
                <button type="button" id="cancelarBtn" class="btn btn-secondary" style="display:none">Cancelar Busca</button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div id="progressSection" class="progress-section" style="display:none;">
        <div class="card">
          <div class="progress-info">
            <span id="progressText" class="progress-text">Coletados 0 de 0 (WA: 0 | Não WA: 0)</span>
            <button id="downloadBtn" class="btn btn-success" style="display:none">Baixar CSV</button>
          </div>
          <div class="progress-bar-container"><div id="progressBar" class="progress-bar" role="progressbar"></div></div>
          <div id="exhaustedWarning" class="exhausted-warning" style="display:none;">
            <div class="warning-icon">⚠️</div>
            <div class="warning-text"><strong>Busca Completa:</strong> Buscamos todos os números disponíveis para essa busca.</div>
          </div>
        </div>
      </div>

      <div id="resultsSection" class="results-section" style="display:none;">
        <div class="card">
          <div class="table-container">
            <table class="results-table" role="table">
              <thead><tr><th scope="col">Telefone</th></tr></thead>
              <tbody id="resultsBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Modal de Login -->
  <div id="loginModal">
    <form class="login-card" onsubmit="handleLoginSubmit(event)">
      <div class="login-logo"><img src="smartleadslogo.png" alt="SmartLeads" /><strong>SmartLeads</strong></div>
      <h3>Entrar</h3>
      <p class="desc">Use o e-mail e a senha fornecidos pela equipe.</p>
      <input id="lg_email" type="email" placeholder="E-mail" required />
      <input id="lg_senha" type="password" placeholder="Senha" required />
      <button type="submit">Acessar</button>
      <div id="lg_msg" class="msg"></div>
    </form>
  </div>

  <!-- Config do backend. NÃO definir SHARED_TOKEN aqui para o login aparecer -->
  <script>window.BACKEND = "https://clickleads.up.railway.app";</script>
  <script src="auth.js"></script>
  <script src="script.js"></script>
</body>
</html>
